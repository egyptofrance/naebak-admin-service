# Architecture Decision Records - خدمة الإدارة

## نظرة عامة

هذا المجلد يحتوي على سجلات القرارات المعمارية (ADRs) الخاصة بخدمة الإدارة في منصة نائبك. تم توثيق هذه القرارات لضمان فهم الأسباب وراء الخيارات التقنية المتخذة وتسهيل الصيانة والتطوير المستقبلي.

## فهرس القرارات

### [ADR-001: نظام الأدوار والصلاحيات المتعدد](./001-multi-role-permission-system.md)
**الحالة:** مقبول  
**التاريخ:** سبتمبر 2024  
**الملخص:** قرار استخدام نظام أدوار متعدد مع دعم الصلاحيات المباشرة لتحقيق أقصى مرونة في إدارة المستخدمين الإداريين.

**القرارات الرئيسية:**
- استخدام `ManyToManyField` للأدوار الإدارية
- دعم الصلاحيات المباشرة بجانب الأدوار
- تطبيق نظام فحص صلاحيات مدمج
- إنشاء أدوار محددة مسبقاً للوظائف الأساسية

### [ADR-002: آلية قفل الحسابات الذكية](./002-account-lockout-mechanism.md)
**الحالة:** مقبول  
**التاريخ:** سبتمبر 2024  
**الملخص:** تصميم نظام قفل حسابات متكيف يوازن بين الأمان القوي وتجربة المستخدم المقبولة.

**القرارات الرئيسية:**
- نظام قفل تدريجي بناءً على عدد المحاولات الفاشلة
- إعادة تعيين العداد تلقائياً بعد فترة زمنية
- إمكانية التدخل اليدوي من المديرين
- تسجيل شامل لجميع محاولات القفل وإلغاء القفل

### [ADR-003: استراتيجية المصادقة الثنائية](./003-two-factor-authentication.md)
**الحالة:** مقبول  
**التاريخ:** سبتمبر 2024  
**الملخص:** اعتماد TOTP كطريقة أساسية للمصادقة الثنائية مع دعم رموز احتياطية للطوارئ.

**القرارات الرئيسية:**
- استخدام TOTP (Time-based One-Time Password) كطريقة أساسية
- دعم تطبيقات المصادقة الشائعة (Google Authenticator, Authy)
- نظام رموز احتياطية للطوارئ
- تكامل سلس مع عملية تسجيل الدخول

### [ADR-004: نظام سجل النشاطات والتدقيق](./004-audit-trail-system.md)
**الحالة:** مقبول  
**التاريخ:** سبتمبر 2024  
**الملخص:** تطبيق نظام تدقيق داخلي شامل لتسجيل جميع النشاطات الإدارية وضمان المساءلة الكاملة.

**القرارات الرئيسية:**
- نظام تدقيق داخلي بدلاً من الخدمات الخارجية
- استخدام Generic Foreign Keys للربط مع جميع النماذج
- تسجيل تلقائي عبر Middleware و Decorators
- نظام تقارير وتحليل متقدم للأنشطة

## إرشادات كتابة ADRs جديدة

### هيكل ADR المعياري

```markdown
# ADR-XXX: عنوان القرار

## الحالة
[مقترح | مقبول | مرفوض | مهجور | محل بـ ADR-YYY]

## السياق والمشكلة
وصف المشكلة أو التحدي الذي يتطلب قراراً معمارياً

## البدائل المدروسة
### البديل 1: الاسم
- المزايا
- العيوب

### البديل 2: الاسم (المختار)
- المزايا  
- العيوب

## القرار المتخذ
شرح القرار والمبررات

## العواقب
### النتائج الإيجابية
### التحديات المحتملة
### استراتيجيات التخفيف

## المراجعة والتقييم
معايير النجاح وجدولة المراجعة
```

### معايير كتابة ADR جيد

1. **الوضوح:** استخدم لغة واضحة ومفهومة
2. **الشمولية:** اذكر جميع البدائل المدروسة
3. **المبررات:** اشرح الأسباب وراء كل قرار
4. **القابلية للتتبع:** ربط القرارات بالمتطلبات والأهداف
5. **التحديث:** حافظ على تحديث الحالة والمعلومات

### عملية الموافقة

1. **الإنشاء:** كتابة ADR بحالة "مقترح"
2. **المراجعة:** مراجعة من فريق التطوير والمعمارية
3. **النقاش:** مناقشة البدائل والمبررات
4. **الموافقة:** تغيير الحالة إلى "مقبول" بعد الموافقة
5. **التطبيق:** تنفيذ القرار في الكود
6. **المراجعة الدورية:** تقييم فعالية القرار

## الأدوات والمراجع

### أدوات مفيدة
- **PlantUML:** لرسم المخططات المعمارية
- **Mermaid:** لرسم المخططات في Markdown
- **ADR Tools:** أدوات سطر الأوامر لإدارة ADRs

### مراجع مفيدة
- [ADR GitHub Organization](https://adr.github.io/)
- [Documenting Architecture Decisions](https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions)
- [Architecture Decision Records in Action](https://www.thoughtworks.com/radar/techniques/lightweight-architecture-decision-records)

## إحصائيات

- **إجمالي ADRs:** 4
- **مقبولة:** 4
- **مقترحة:** 0
- **مرفوضة:** 0
- **آخر تحديث:** سبتمبر 2024

## جهات الاتصال

- **فريق المعمارية:** architecture@naebak.gov.eg
- **فريق الأمان:** security@naebak.gov.eg
- **فريق التطوير:** dev@naebak.gov.eg

---

**ملاحظة:** هذا المستند حي ويتم تحديثه باستمرار. يرجى مراجعة آخر إصدار قبل اتخاذ قرارات معمارية جديدة.
